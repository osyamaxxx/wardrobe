package com.example.wardrobeapp

import android.app.Activity
import android.graphics.Color
import android.os.Bundle
import android.util.TypedValue
import android.view.View
import android.view.ViewGroup
import android.widget.FrameLayout
import android.webkit.WebView
import android.webkit.WebViewClient

class MainActivity : Activity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        // ãƒ™ãƒ¼ã‚¹ã® layoutï¼ˆç”»é¢å…¨ä½“ï¼‰
        val root = FrameLayout(this)

        // ğŸ”´ é’ã„ãƒãƒ¼ã‚’å®Œå…¨é®æ–­ã™ã‚‹é»’ã„ãƒ“ãƒ¥ãƒ¼
        val topMask = View(this)
        topMask.setBackgroundColor(Color.BLACK)

        // ã”ä¸»äººæ§˜ã®ã‚¹ã‚¯ã‚·ãƒ§ã‚’è¦‹ã‚‹é™ã‚Šã€80dp ãã‚‰ã„éš ã›ã°å®‰å…¨
        val maskHeight = dp(49f)  // èª¿æ•´OKï¼

        val maskParams = FrameLayout.LayoutParams(
            FrameLayout.LayoutParams.MATCH_PARENT,
            maskHeight
        )
        maskParams.topMargin = 0
        topMask.layoutParams = maskParams

        // ğŸŸ¢ WebView
        val webView = WebView(this)
        webView.settings.javaScriptEnabled = true
        webView.settings.domStorageEnabled = true
        webView.settings.userAgentString =
            "Mozilla/5.0 (Linux; Android 10; Mobile) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0 Mobile Safari/537.36"
        webView.webViewClient = WebViewClient()

        // ğŸŸ¡ WebView ã‚’èµ¤ã„æ ãã‚‰ã„ã¾ã§ã«å›ºå®šï¼ˆä¸Šã‚’éš ã™ï¼‰
        val webParams = FrameLayout.LayoutParams(
            FrameLayout.LayoutParams.MATCH_PARENT,
            FrameLayout.LayoutParams.MATCH_PARENT
        )
        webParams.topMargin = -maskHeight  // â† è¡¨ç¤ºé ˜åŸŸã‚’ä¸Šã«ã‚ºãƒ©ã™(é’ãƒãƒ¼ã‚’ä¸Šã«è¿½ã„ã‚„ã‚‹)
        webParams.bottomMargin = dp(70f)   // â† ä¸‹ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®è¢«ã‚Šå¯¾ç­–

        webView.layoutParams = webParams

        // URL èª­ã¿è¾¼ã¿ è‡ªåˆ†ã®gasã®URLã‚’å…¥ã‚Œã‚‹
        webView.loadUrl("")

        // ç”»é¢ã«è¦ç´ ã‚’è¿½åŠ 
        root.addView(webView)
        root.addView(topMask)  // â† é»’ã„ãƒã‚¹ã‚¯ã§ä¸Šã‚’å®Œå…¨é®æ–­

        setContentView(root)
    }

    private fun dp(value: Float): Int {
        return TypedValue.applyDimension(
            TypedValue.COMPLEX_UNIT_DIP,
            value,
            resources.displayMetrics
        ).toInt()
    }
}
